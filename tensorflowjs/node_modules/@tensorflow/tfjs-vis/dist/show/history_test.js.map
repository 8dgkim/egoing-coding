{"version":3,"file":"history_test.js","sourceRoot":"","sources":["../../src/show/history_test.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright 2018 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n\nimport {fitCallbacks, history} from './history';\n\ndescribe('fitCallbacks', () => {\n  beforeEach(() => {\n    document.body.innerHTML = '<div id=\"container\"></div>';\n  });\n\n  it('returns two callbacks', async () => {\n    const container = {name: 'Test'};\n    const callbacks = fitCallbacks(container, ['loss', 'acc']);\n\n    expect(typeof (callbacks.onEpochEnd)).toEqual('function');\n    expect(typeof (callbacks.onBatchEnd)).toEqual('function');\n  });\n\n  it('returns one callback', async () => {\n    const container = {name: 'Test'};\n    const callbacks = fitCallbacks(container, ['loss', 'acc'], {\n      callbacks: ['onBatchEnd'],\n    });\n\n    expect(callbacks.onEpochEnd).toEqual(undefined);\n    expect(typeof (callbacks.onBatchEnd)).toEqual('function');\n  });\n\n  it('onEpochEnd callback can render logs', async () => {\n    const container = {name: 'Test'};\n    const callbacks =\n        fitCallbacks(container, ['loss', 'val_loss', 'acc', 'val_acc']);\n\n    const l1 = {loss: 0.5, 'val_loss': 0.7};\n    const l2 = {loss: 0.2, acc: 0.6, 'val_loss': 0.5, 'val_acc': 0.3};\n\n    await callbacks.onEpochEnd(0, l1);\n    expect(document.querySelectorAll('.vega-embed').length).toBe(1);\n    expect(document.querySelectorAll('div[data-name=\"loss\"]').length).toBe(1);\n\n    await callbacks.onEpochEnd(1, l2);\n    expect(document.querySelectorAll('.vega-embed').length).toBe(2);\n    expect(document.querySelectorAll('div[data-name=\"loss\"]').length).toBe(1);\n    expect(document.querySelectorAll('div[data-name=\"acc\"]').length).toBe(1);\n  });\n\n  it('onBatchEnd callback can render logs', async () => {\n    const container = {name: 'Test'};\n    const callbacks = fitCallbacks(container, ['loss', 'acc']);\n\n    const l1 = {loss: 0.5};\n    const l2 = {loss: 0.2, acc: 0.6};\n\n    await callbacks.onBatchEnd(0, l1);\n    expect(document.querySelectorAll('.vega-embed').length).toBe(1);\n    expect(document.querySelectorAll('div[data-name=\"loss\"]').length).toBe(1);\n\n    await callbacks.onBatchEnd(1, l2);\n    expect(document.querySelectorAll('.vega-embed').length).toBe(2);\n    expect(document.querySelectorAll('div[data-name=\"loss\"]').length).toBe(1);\n    expect(document.querySelectorAll('div[data-name=\"acc\"]').length).toBe(1);\n  });\n});\n\ndescribe('history', () => {\n  beforeEach(() => {\n    document.body.innerHTML = '<div id=\"container\"></div>';\n  });\n\n  it('renders a logs[]', async () => {\n    const container = {name: 'Test'};\n    const logs = [{loss: 0.5}, {loss: 0.3}];\n    const metrics = ['loss'];\n    await history(container, logs, metrics);\n\n    expect(document.querySelectorAll('.vega-embed').length).toBe(1);\n  });\n\n  it('renders a logs object with multiple metrics', async () => {\n    const container = {name: 'Test'};\n    const logs = [{loss: 0.2, acc: 0.6}, {loss: 0.1, acc: 0.65}];\n    const metrics = ['loss', 'acc'];\n    await history(container, logs, metrics);\n\n    expect(document.querySelectorAll('.vega-embed').length).toBe(2);\n  });\n\n  it('renders a history object with multiple metrics', async () => {\n    const container = {name: 'Test'};\n    const hist = {\n      history: {\n        'loss': [0.7, 0.3, 0.2],\n        'acc': [0.2, 0.3, 0.21],\n      }\n    };\n    const metrics = ['loss', 'acc'];\n    await history(container, hist, metrics);\n\n    expect(document.querySelectorAll('.vega-embed').length).toBe(2);\n  });\n\n  it('can render multiple history objects', async () => {\n    const container = {name: 'Test'};\n    const container2 = {name: 'Other Test'};\n    const hist = {\n      history: {\n        'loss': [0.7, 0.3, 0.2],\n        'acc': [0.2, 0.3, 0.21],\n      }\n    };\n\n    await history(container, hist, ['loss']);\n    await history(container2, hist, ['acc']);\n\n    expect(document.querySelectorAll('.vega-embed').length).toBe(2);\n  });\n});\n"]}