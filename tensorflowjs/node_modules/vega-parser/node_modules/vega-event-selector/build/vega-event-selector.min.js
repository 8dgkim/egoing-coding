!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).vega={})}(this,(function(e){"use strict";const t="[",r="]",n=/[[\]{}]/,i={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let o,s;function l(e,t,r,n,i){const o=e.length;let s,l=0;for(;t<o;++t){if(s=e[t],!l&&s===r)return t;i&&i.indexOf(s)>=0?--l:n&&n.indexOf(s)>=0&&++l}return t}function c(e){const t=[],r=e.length;let n=0,i=0;for(;i<r;)i=l(e,i,",","[{","]}"),t.push(e.substring(n,i).trim()),n=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function f(e){return"["===e[0]?function(e){const n=e.length;let i,o=1;if(o=l(e,o,r,t,r),o===n)throw"Empty between selector: "+e;if(i=c(e.substring(1,o)),2!==i.length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(o+1).trim())[0])throw"Expected '>' after between selector: "+e;i=i.map(f);const s=f(e.slice(1).trim());if(s.between)return{between:i,stream:s};s.between=i;return s}(e):function(e){const i={source:o},c=[];let f,u,h=[0,0],a=0,p=0,m=e.length,g=0;if("}"===e[m-1]){if(g=e.lastIndexOf("{"),!(g>=0))throw"Unmatched right brace: "+e;try{h=function(e){const t=e.split(",");if(!e.length||t.length>2)throw e;return t.map((t=>{const r=+t;if(r!=r)throw e;return r}))}(e.substring(g+1,m-1))}catch(t){throw"Invalid throttle specification: "+e}m=(e=e.slice(0,g).trim()).length,g=0}if(!m)throw e;"@"===e[0]&&(a=++g);f=l(e,g,":"),f<m&&(c.push(e.substring(p,f).trim()),p=g=++f);if(g=l(e,g,t),g===m)c.push(e.substring(p,m).trim());else if(c.push(e.substring(p,g).trim()),u=[],p=++g,p===m)throw"Unmatched left bracket: "+e;for(;g<m;){if(g=l(e,g,r),g===m)throw"Unmatched left bracket: "+e;if(u.push(e.substring(p,g).trim()),g<m-1&&e[++g]!==t)throw"Expected left bracket: "+e;p=++g}if(!(m=c.length)||n.test(c[m-1]))throw"Invalid event selector: "+e;m>1?(i.type=c[1],a?i.markname=c[0].slice(1):(b=c[0],s[b]?i.marktype=c[0]:i.source=c[0])):i.type=c[0];var b;"!"===i.type.slice(-1)&&(i.consume=!0,i.type=i.type.slice(0,-1));null!=u&&(i.filter=u);h[0]&&(i.throttle=h[0]);h[1]&&(i.debounce=h[1]);return i}(e)}e.parseSelector=function(e,t,r){return o=t||"view",s=r||i,c(e.trim()).map(f)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=vega-event-selector.min.js.map
